<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>test case result</title>
        <h:outputStylesheet library="css" name="default.css" />
        <h:outputStylesheet library="css" name="table-style.css"  />
    </h:head>
    <h:body>
        <h4>Tests Result</h4>

        <f:metadata>
            <f:viewParam name ="number" value="#{testsBean.number}">
                <f:validateLongRange minimum="1" maximum="1000" />
            </f:viewParam>
            <f:event type="preRenderView" listener="#{testsBean.loadTestResults()}" />
        </f:metadata>

        <h:form>
            <h:panelGrid id="panel" columns="3" border="0" cellpadding="5" cellspacing="0">
                <h:panelGroup>
                    <h:outputLabel id="ltestclass" value="#{testsBean.testClass}"/>
                    <h:outputLabel value="." />
                    <h:outputLabel id="ltestmethod" value="#{testsBean.testMethod}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel id="lstarttime" for="starttime" value="start: "/>
                    <p:calendar id="starttime" pattern="yyyy-MM-dd HH:mm" value="#{testsBean.startTime}" />
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel id="lstoptime" for="stoptime" value="stop: " />
                    <p:calendar id="stoptime" pattern="yyyy-MM-dd HH:mm" value="#{testsBean.stopTime}" />
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel id="lnumber" for="number" value="maximum number of records: "/>
                    <h:inputText value="#{testsBean.number}" id="number"/>
                    <h:commandButton id="query" value="query" action="tests.xhtml" />
                </h:panelGroup>
            </h:panelGrid>

            <h:inputHidden value="#{testsBean.testClass}" id="testclass"/>
            <h:inputHidden value="#{testsBean.testMethod}" id="testmethod"/>

        </h:form>
        <h:dataTable value="#{testsBean.tests}"
                     var="test"
                     styleClass="order-table"
                     headerClass="order-table-header"
                     rowClasses="order-table-odd-row,order-table-even-row"
                     columnClasses="none,none,none,none,none,centered">
            <h:column>
                <f:facet name="header">index</f:facet>
                    #{test.get("_row_index")}
            </h:column>                    
            <h:column>
                <f:facet name="header">id</f:facet>
                <h:outputLink value ="#{test.get('TEST_CASE_ID')}" target="_blank">
                    <f:param name="testid" value='#{test.get("TEST_CASE_ID")}' />
                </h:outputLink>
            </h:column>
            <h:column>
                <f:facet name="header">start time</f:facet><nobr>
                    <h:outputText value="#{testsBean.convertToDate(test.get('START_TIME'))}">
                        <f:convertDateTime type="date" pattern="yyyy-MM-dd HH:mm:ss.SSS" timeZone="US/Pacific" />
                    </h:outputText></nobr>
            </h:column>
            <h:column>
                <f:facet name="header">stop time</f:facet><nobr>
                    <h:outputText value="#{testsBean.convertToDate(test.get('STOP_TIME'))}">
                        <f:convertDateTime type="date" pattern="yyyy-MM-dd HH:mm:ss.SSS" timeZone="US/Pacific" />
                    </h:outputText></nobr>
            </h:column>
            <h:column>
                <f:facet name="header">result</f:facet>
                <h:outputLabel value='#{test.get("EXECUTION_RESULT")}'
                               class='pass' rendered='#{test.get("_row_result")}' />
                <h:outputLabel value='#{test.get("EXECUTION_RESULT")}'
                               class='fail' rendered='#{not test.get("_row_result")}' />
                <h:outputLink value ="#{test.get('LOG_URL')}" target="_blank">
                    <h:graphicImage library="resources" name="img/link.png" width='16' />
                </h:outputLink>
            </h:column>
        </h:dataTable>
    </h:body>
</html>

